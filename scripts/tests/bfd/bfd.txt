
Generic BFD Control Packet Format


    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |Vers |  Diag   |Sta|P|F|C|A|D|M|  Detect Mult  |    Length     |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                       My Discriminator                        |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                      Your Discriminator                       |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                    Desired Min TX Interval                    |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                   Required Min RX Interval                    |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                 Required Min Echo RX Interval                 |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+


   Vers

      1

   Diag

         0 = No Diagnostic

         1 = Control Detection Time Expired

         2 = Echo Function Failed

         3 = Neighbor Signaled Session Down

         4 = Forwarding Plane Reset

         5 = Path Down

         6 = Concatenated Path Down

         7 = Administratively Down

         8 = Reverse Concatenated Path Down

      9-31 = Reserved for future use

      This field allows remote systems to determine the reason that the
      previous session failed, for example.

   Sta

      The current BFD session state as seen by the transmitting system.
      Values are:


         0 = AdminDown

         1 = Down

         2 = Init

         3 = Up

   P

      If set, the transmitting system is requesting verification of
      connectivity, or of a parameter change, and is expecting a packet
      with the Final (F) bit in reply.  If clear, the transmitting
      system is not requesting verification.

   F

      If set, the transmitting system is responding to a received BFD
      Control packet that had the Poll (P) bit set.  If clear, the
      transmitting system is not responding to a Poll.

   C

      If set, the transmitting system's BFD implementation does not
      share fate with its control plane (in other words, BFD is
      implemented in the forwarding plane and can continue to function
      through disruptions in the control plane).  If clear, the
      transmitting system's BFD implementation shares fate with its
      control plane.

      The use of this bit is application dependent and is outside the
      scope of this specification.  See specific application
      specifications for details.

   A

      If set, the Authentication Section is present and the session is
      to be authenticated (see section 6.7 for details).

   D

      If set, Demand mode is active in the transmitting system (the
      system wishes to operate in Demand mode, knows that the session is
      Up in both directions, and is directing the remote system to cease
      the periodic transmission of BFD Control packets).  If clear,
      Demand mode is not active in the transmitting system.

   M

      This bit is reserved for future point-to-multipoint extensions to
      BFD.  It MUST be zero on both transmit and receipt.

   Detect Mult

      Detection time multiplier.  The negotiated transmit interval,
      multiplied by this value, provides the Detection Time for the
      receiving system in Asynchronous mode.

   Length

      Length is Length of the BFD Control packet, in bytes.

   My Discriminator

      A unique, nonzero discriminator value generated by the
      transmitting system, used to demultiplex multiple BFD sessions
      between the same pair of systems.

   Your Discriminator

      The discriminator received from the corresponding remote system.
      This field reflects back the received value of My Discriminator,
      or is zero if that value is unknown.

   Desired Min TX Interval

      This is the minimum interval, in microseconds, that the local
      system would like to use when transmitting BFD Control packets,
      less any jitter applied (see section 6.8.2).  The value zero is
      reserved.

   Required Min RX Interval

      This is the minimum interval, in microseconds, between received
      BFD Control packets that this system is capable of supporting,
      less any jitter applied by the sender (see section 6.8.2).  If
      this value is zero, the transmitting system does not want the
      remote system to send any periodic BFD Control packets.

   Required Min Echo RX Interval

      This is the minimum interval, in microseconds, between received
      BFD Echo packets that this system is capable of supporting, less
      any jitter applied by the sender (see section 6.8.9).  If this
      value is zero, the transmitting system does not support the
      receipt of BFD Echo packets.

   Auth Type

      The authentication type in use, if the Authentication Present (A)
      bit is set.

         0 = Reserved

         1 = Simple Password

         2 = Keyed MD5

         3 = Meticulous Keyed MD5

         4 = Keyed SHA1

         5 = Meticulous Keyed SHA1

     6-255 = Reserved for future use

   Auth Len

      The length, in bytes, of the authentication section, including the
      Auth Type and Auth Len fields.
